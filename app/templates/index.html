{% extends 'base.html' %}

{% block content %}
	<h2>Conversations</h2>
	<dl>
		{% for thread in threads %}
			<dt>
			{% if thread.user %}
				<i class="icon-lock"></i>
			{% endif %}
			{% if threads[thread] %}
				<a href="{{ url_for('new_thread') }}/{{ thread.display_hash|safe }}/{{ thread.slug()|safe }}#p{{ threads[thread] }}">{{ thread.title|safe }}</a>
			{% else %}
				<a href="{{ url_for('new_thread') }}/{{ thread.display_hash|safe }}/{{ thread.slug()|safe }}">{{ thread.title|safe }}</a>
			{% endif %}
			</dt>
			<dd>
				{% if thread.nsfw %}
					<abbr class="nsfw">NSFW</abbr>&nbsp;
				{% endif %}
				<time pubdate="pubdate">{{ thread.date_created|safe }}</time>&nbsp;
				
				{{ thread.posts|count() }} Posts&nbsp;
				
				{% if thread.user %}
					<strong><a href="{{ url_for('user', display_hash=thread.user.display_hash, action=None) }}">{{ thread.user.username|safe }}</a></strong>
				{% else %}
					<strong>{{ thread.display_name|safe }}</strong>
				{% endif %}
			</dd>
		{% endfor %}
	</dl>
	<ul class="centered pure-paginator">
	    {% if pagination.has_prev %}<li><a class="prev" href="{{ url_for('index', page=pagination.prev_num) }}">&#171;</a></li>{% endif %}
		<li>&nbsp</li>
		<li><small>{{ pagination.page }} of {{ pagination.pages }}</small></li>
		<li>&nbsp</li>
	    {% if pagination.has_next %}<li><a class="next" href="{{ url_for('index', page=pagination.next_num) }}">&#187;</a></li>{% endif %}
	</ul>
{% endblock %}